<?
$adhs = <<<EOT
056001;Kerstran;;BRECH;56400;ALRE CHAUFFAGE SANITAIRE
056002;ZA de Mané Coetdigo;Rue Molène;PLOEREN;56880;ARHUERO
056003;1 lot des Rivages;;QUESTEMBERT;56230;BOULAY JEAN-MARC
056004;ZA de Montauban;;CARNAC;56340;CAILLOCE EHANNO
056005;ZA de Kermarrec;;BAUD;56150;CHAUFFAGE SANITAIRE SERVICES
056006;ZA de BELLEVUE;;MERLEVENEZ;56700;CORLAY DAVID
056007;ZAC du Parc;;MUZILLAC;56190;DANION CHRISTIAN
056008;ZA du Lesty;;AMBON;56190;DREANO LOUIS
056009;3 Avenue du Palud;;CARNAC;56340;DURAND MICHEL
056010;ZA Porte Océane;9 rue du danemark;AURAY;56400;GARREC  ET CIE
056013;71 rue du Général Weygand;;VANNES;56000;JIQUEL PIERRE
056015;19 rue Notre Dame de Becquerel;;PLOUGOUMELEN;56400;LE CORVEC PATRICK
056016;Rue Saint Georges;;PLUVIGNER;56330;LE HENANFF PASCAL
056017;29  Rue de l'Industrie;;BIGNAN;56500;LE LABOURIER Y.
056019;36 Rue des Déportés;;PLAUDREN;56420;LE TALLEC BERNARD
056021;15 Rue J.B. de la Salle;;QUESTEMBERT;56230;MAGRE SARL
056022;Bande de Haute Ville;;PLUMELEC;56420;MAHE JEAN
056024;24 chemin Fontaine Guéhec;;NOYALO;56450;MONTFORT ROGER
056025;9 rue des Ecoles;;SENE;56860;MORICE FRERES
056026;Avenue de Geispolshem;;SENE;56860;MOUGIN MICHEL
056027;La Grée Le Beauchat;;SAINT GRAVE;56220;NAEL MICHEL
056028;8 PA de l'Estuaire;;ARZAL;56190;PERRIN JEAN-PIERRE
056029;ZA de Kermassonnet;;KERVIGNAC;56700;PHILIPPE RÉMY
056030;21 Rue des Chênes;;PEAULE;56130;QUELARD YANNICK
056031;Le Spernec;;SARZEAU;56370;ROUZIC CHRISTIAN
056032;parc d'Activité de la Chaussée;;MALANSAC;56220;RYO
056033;Zone artisanale de Kerran;;SAINT PHILIBERT;56470;SAINT-MARTIN MARC
056035;10 rue Penher Pichon;;ST JEAN BREVELAY;56660;DEVAUX TATIBOUET
056036;les Fossés;bp 28;MAURON;56430;THAMIN FABRICE
056037;Parc de restavy;;PLOUAY;56240;TRECANT STÉPHANE
056038;17 rue du Drézen;;VANNES;56000;LES LICES
056039;Artipole;;PLESCOP;56890;CAB 56
056040;ZA de kergrippe;;SENE;56860;GUILLO PATRICK
056042;5 place Marcel  Jégo;;CRACH;56950;BOTHUA CHAUFFAGE
056043;11, chemin des Ecureuils;;BAUD;56150;LE GUILLANT DOMINIQUE
056044;Lieu dit GUENANDERFF;;GRANDCHAMP;56390;ABLAIN GICQUELET
056045;Kercadoret;;LOCMARIAQUER;56740;GROUHEL LIONEL
056046;25 rue stanislas dupuy de Lome;;VANNES;56000;LE METOUR ELECTRICITE
056047;Z.A. DE KEROVEL;;GRAND CHAMP;56390;SOMELEC
056050;La Vieille Poste;;MUZILLAC;56190;CRENO CHRISTOPHE
056051;ZONE DE LA LANDE;;DAMGAN;56750;JUBERT LOÏC
056052;19 impasse des Violettes;;BRECH;56400;BLAISE GILLES
056054;27 rue Henri Geffroy;;PORCARO;56380;GARIN JEAN PAUL
056055;Les Grées;;PLUHERLIN;56220;ROBERT JEAN LUC
056057;9 rue des Anciens Combattants;;BADEN;56870;JO CORNEC DOMOTIQUE JCD
056058;6 bis rue Saint Maurice;;GUIDEL;56520;THOMAS LEON
056060;ZA de Pont laurence;;PLOEMEL;56400;LE GUILLANT DANIEL
056061;Bat Defvan;ZA du Landy;THEIX;56450;AAA TES
056062;73 rue Louis Roche;;LORIENT;56100;KERLO CHRISTIAN
056063;Kerbihan;Koz Dervenn;TREFFLEAN;56250;OILLIC SERGE
056064;Langonan;;PLEUGRIFFET;56120;P.C.R.D.
056065;6 rue du Clos Havard;;PLOERMEL;56800;HERVE GUILLAUME
056066;za de kérian;;LE BONO;56400;LE BLOCH GENERATION CONFORT
056067;Parc d'Activités du Val d'Oust;;SAINT ABRAHAM;56140;BROCELIANDE ELECTRICITE
056069;5 allée du Govérich;;ARRADON;56610;D .M.
056071;6 impasse de la Forêt;;COLPO;56390;ITS GENC
056072;Kerunon;;GUIDEL;56520;BI'EAU REFLEXE
056073;11 route de Locminé;;BAUD;56150;CABEDOCE ANTHONY
056074;ZA La Dabonnière;;GUER COETQUIDAN;56380;DANILO JEAN CHARLES
056075;3 allée des Tilleuls;;SARZEAU;56370;GUIHUR JAMES
056076;ZA de Kersaux;;SAINT GILDAS DE RHUYS;56730;BEYAERT GIRARD
056077;112 rue du Général de Gaulle;;SAINTE ANNE D AURAY;56400;BRETAGNE PLOMBERIE CHAUFFAGE
056079;3 rue Le Clos Person;;SURZUR;56450;SAVARY YANNICK
056080;Les Castillez;;LIZIO;56460;THOMAS BRUNO
056081;10 rue Xavier Grall;;MERIADEC;56400;LG ELECTRICITE - M. LE GALL PHILIP.
056082;22 route D'ARMORIQUE;;LA TRINITE SURZUR;56190;LE NOCHER CHRISTOPHE
056084;Kerralan;;QUESTEMBERT;56230;LAUNAY MICHEL
056083;Lieu dit Brouel;;ILE AUX MOINES;56780;LECULLEE MARC
056078;BRANGOURETTE;;LIMERZEL;56220;DIQUERO PIERRE YVES
056085;La BOE;;SAINT ABRAHAM;56140;MERVEILLEUX RICHARD
056086;ZONE DU MOULIN NEUF;;PEAULE;56130;THEAUDIN
056087;9 RUE COLONEL LE BARILLEC;;LORIENT;56100;MATHYS
056088;PA de Kerboulard;;SAINT-NOLFF;56250;THOMAS - MOISAN
056090;ZA DE LANN VRIHAN;;LE HEZO;56450;MERCIER ENERGIES
056091;8 rue des MESANGES;;ALLAIRE;56350;ENERG CLIM OUEST LOGIS SCES
056092;5 rue de la Fontaine;;BIGNAN;56500;LEVEQUE FRERES
056093;KERGUYONVARCH;;LANGUIDIC;56440;CAUGANT SEBASTIEN
056094;Le petit Moustoir;;THEIX;56450;BLOUET
056095;KERGROSSE;;ERDEVEN;56410;RENO BAT 56
056096;LA CHOUANIERE;;LIMERZEL;56220;LE COINTE CHRISTOPHE
056097;1 RUE DE VERDUN;;LOCMINE;56500;MENA CONFORT
056098;Les Hauts du Ponant;;SAINT PHILIBERT;56470;GUEGANIC CHRISTOPHE
056100;KERGONAN;;PLUMELEC;56420;SAMMARITANO BERNARD
056101;Allée de Kerdogan;;SAINT AVE;56890;LEPIOUFLE YANNICK
056102;45 avenue de Verdun;;VANNES;56000;AB SANIT EXPRESS M. BINARD
056104;2 Impasse de l'Aubépine;;SARZEAU;56370;ATLANTIQUE CONFORT
056105;8 ALLEE ARTHUR RIMBAUD;;VANNES;56000;NEOTOM
056106;Kervilio;;LANDEVANT;56690;LE NEILLON
056107;Lieu dit LANN GABELLEC;;LA TRINITE SUR MER;56470;MARCHAND FREDERIC
056108;Monsieur Laurent LAFOSSE;9 RUE DE KERENTREC;ROHAN;56580;THERMO FREEZE
056109;Monsieur GUUINIC Franck;18 rue Job Le Bayon;COLPO;56390;HABITAT ELEC
056110;ZA de Kermarquer;24 rue du Cabestan;LA TRINITE SUR MER;56470;CAILLOCE FRANCOIS
056111;8 rue du Puits Fleuri;Toulindac;BADEN;56870;ROBERT STÉPHANE
056112;28 rue de Grahouël;;THEIX;56450;LAURENT LUC
056114;M. TEXIER Stéphane;Lieu Dit Collec;LOCMARIA GRANDCHAMP;56390;S.T. ELEC
056115;M. BRIEND Didier;ZA de Kerian;LE BONO;56400;BONO ELEC
056117;Monsieur JAN Bruno;2 rue François Guyodo;MEUCON;56890;BRUN'EAU PLOMBERIE
056118;ZA DE KERIAN;10 BIS RUE JOSEPH LE DOUARAN;LE BONO;56400;GENERATION ELEC
056119;Le Gohlen;;PLOEREN;56880;PRIGENT ELECTRICITE
056121;ZA de LANN TOURLAREC;;BADEN;56870;CORNEC PAC ELEC
056122;tréflis;;ST NOLFF;56250;DANY HERVÉ
056123;QUEMENER Christophe;Le Pont du Bonhomme;KERVIGNAC;56700;AIREO CHAUFFAGE
056124;Monsieur Julien BOCQUET;Moulin Lévêque;PLESCOP;56890;AVENIR ENERGIES
056125;15 rue de Tournebride;;PLUHERLIN;56220;BRIAND STÉPHANE
056126;LE BIHAN Erwan;3 Impasse du Soleil Levant;SENE;56860;LB PLOMBERIE
056127;PRO HOTEL SERVICES;9 rue de la Boucherie;VANNES;56000;GAUTIER VINCENT
056128;1 rue Louis Cren;;LORIENT;56100;A-Z THERM
056129;11 Place du loch;Résidence du loch - Bat A;AURAY;56400;LE CANDERF SÉBASTIEN
056130;21 rue du Port de Pêche;;QUIBERON;56170;LE PAVEC CHRISTIAN
056131;Rue Blaise Pascal;ZA de Tréhuinec;PLESCOP;56890;LE GAL
056132;LE RESTHenri;108 Impasse Jacques Ange Gabriel;CAUDAN;56850;ALLO PLOMBERIE
056133;ZI de Bel Orient;;BOHAL;56140;SMME
056134;ZA de Lamboux;;ELVEN;56250;MODERN ELEC
056135;Domaine de Saint Guen;4 rue Marc Elder;VANNES;56000;SCHLEGEL JÉRÔME
056136;Monsieur PAMPANAY JP;12 rue des Aubépines;PLOUGOUMELEN;56400;SAG ATELIER GENERAL
056137;3 résidence des Glycines;76 avenue du Gal de Gaulle;PLESCOP;56890;STEPH'ELEC MME DERRIEN STEPHANIE
056138;5 place Théodore Botherel;;SERENT;56460;GUYOT LUDOVIC
056139;Lann Kerguy;;PLUVIGNER;56330;MAEVA ENERGIE
056140;AHEE FRERES;Kerhello;BILLIO;56420;GRANDIN-LE BARBIER
056141;Zone Kervault;;QUESTEMBERT;56230;POUPLIEE DOMINIQUE
056142;ZA de Tréhuinec;Rue Blaise Pascal;PLESCOP;56890;GARAUD ERIC
056143;5T avenue des CItés Unies;;PONTIVY;56300;PHILIPPE JEAN JACQUES
056144;17 rue de Normandie;;VANNES;56000;TANDEAU DE MARSAC BRUNO
EOT;

// parse de la bd des adhs
$adhs_r = explode("\n",$adhs);
	for($i=0 ; $i<sizeof($adhs_r) ; $i++) {
		if (preg_match('/^(//|--)/',$adhs_r[$i])) { continue; } // si commentaire, on saute
//	for($i=0 ; $i < 1 ; $i++) {
		$infos = explode(';',$adhs_r[$i]);
		$address = join(',',array($infos[1],$infos[2],$infos[3],$infos[4],'France')) ; // adr1, adr2, cp, ville, france
		$url = "http://maps.google.com/maps/geo?".
				"q=".urlencode($address).
				"&output=json".
				"&oe=utf8".
				"&sensor=false".
				"&key=ABQIAAAAMx3AS4X9Q7p1SOnWl39WTxQ5WLt7FAWpyYOkpoLAYz7qs84QwhSsLYmywJsMv8-V7B8uKj7_s6LhWw" ;

		$json = json_decode(join('',file($url)));
//print_r(get_object_vars($json));
		if ($json->{'Status'}->{'code'} == 200) {
			echo join(';',array(
							$infos[0],
							$json->{'Placemark'}[0]->{'Point'}->{'coordinates'}[1].','.$json->{'Placemark'}[0]->{'Point'}->{'coordinates'}[0]
						)
				);
			echo "<br>\n";
		} else {
			echo join(';',array(
							$infos[0],
							$address
						)
				);
			echo "<br>\n";
		}
	}
?>